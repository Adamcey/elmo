<% unless empty_qing_group?(subtree) %>

  <% children = subtree.keys %>
  <% grid_mode = grid_mode?(children) %>

  <group appearance="field-list">
    <label><%= group.group_name %></label>

    <%# In grid mode, we need to render a special label row that prints the available options at the top of the grid. %>
    <% if grid_mode %>
      <%= render('odk_questioning', qing: children.first, grid_mode: true, label_row: true) %>
    <% end %>

    <%# Render children. %>
    <% subtree.each do |item, subsubtree| %>
      <% if item.is_a?(QingGroup) %>
        <%= render('odk_group', group: item, subtree: subsubtree) %>
      <% else %>
        <%# Tell any children questionings whether we are in grid_mode. %>
        <%= render('odk_questioning', qing: item, grid_mode: grid_mode) unless item.hidden %>
      <% end %>
    <% end %>
  </group>
<% end %>
